@model Inventarios.Models.UsuarioRolViewModel
@{
    ViewData["Title"] = "Detalle de Usuario";
    var roles = ViewBag.Roles as string[] ?? new[] { "Admin", "Usuario" };
}

<!-- HEADER -->
<div class="mb-4">
    <h1>ğŸ‘¤ @Model.Correo</h1>
    <p class="text-muted">InformaciÃ³n y permisos del usuario</p>
</div>

<!-- INFORMACIÃ“N PRINCIPAL -->
<div class="row">
    <div class="col-lg-6">
        <div class="card mb-4">
            <div class="card-header">
                <strong>ğŸ“‹ InformaciÃ³n del Usuario</strong>
            </div>
            <div class="card-body">
                <div class="mb-4">
                    <h6 class="text-muted">ğŸ“§ Correo ElectrÃ³nico</h6>
                    <p class="h6">@Model.Correo</p>
                </div>
                <div class="mb-4">
                    <h6 class="text-muted">ğŸ”‘ ID del Usuario</h6>
                    <p class="h6"><code>@Model.Id.Substring(0, 12)...</code></p>
                </div>
                <div>
                    <h6 class="text-muted">ğŸ‘¤ Rol(es) Actual(es)</h6>
                    <div>
                        @if (Model.Roles?.Count > 0)
                        {
                            @foreach (var rol in Model.Roles)
                            {
                                var badgeClass = rol == "Admin" ? "badge bg-danger text-white" : "badge bg-success text-white";
                                var roleIcon = rol == "Admin" ? "ğŸ”´" : "ğŸŸ¢";
                                <span class="@badgeClass me-2">@roleIcon @rol</span>
                            }
                        }
                        else
                        {
                            <span class="badge bg-secondary text-white">âš ï¸ Sin rol</span>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- CAMBIAR ROL -->
    <div class="col-lg-6">
        <div class="card mb-4">
            <div class="card-header">
                <strong>ğŸ” GestiÃ³n de Rol</strong>
            </div>
            <div class="card-body">
                <form asp-action="CambiarRol" method="post">
                    <input type="hidden" name="id" value="@Model.Id" />

                    <div class="form-group mb-3">
                        <label for="rol" class="form-label">Seleccionar Rol</label>
                        <select class="form-select form-select-lg" name="rol" id="rol" required>
                            @foreach (var rol in roles)
                            {
                                var isSelected = Model.Roles?.Contains(rol) == true;
                                <option value="@rol" selected="@isSelected">
                                    @if (rol == "Admin")
                                    {
                                        <span>ğŸ”´ @rol</span>
                                    }
                                    else
                                    {
                                        <span>ğŸŸ¢ @rol</span>
                                    }
                                </option>
                            }
                        </select>
                        <small class="form-text text-muted d-block mt-2">
                            Admin: Acceso total. Usuario: Acceso limitado.
                        </small>
                    </div>

                    <button class="btn btn-primary w-100" type="submit">
                        ğŸ’¾ Actualizar Rol
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- ACCIONES -->
<div class="d-flex gap-2">
    <a class="btn btn-secondary" asp-action="Index">
        â† Volver al Listado
    </a>
    <a class="btn btn-outline-danger" asp-action="Eliminar" asp-route-id="@Model.Id">
        ğŸ—‘ï¸ Eliminar Usuario
    </a>
</div>
